#!/usr/bin/python3

import socket
import sys
import time

threads = 1

if len(sys.argv) < 2:
    print("Utilize: ", sys.argv[0], "<ip do host>", "<num threads>")
    exit(-1)
elif len(sys.argv) == 3:
    threads = sys.argv[2]

host = sys.argv[1]

tcpSock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
portasAbertas = ""

for porta in range(1, 65536):
    try:
        tcpSock.connect((host, porta))
        rcv = tcpSock.recv(1024).decode('utf-8').strip()
        if len(rcv) > 0:
            print("Porta aberta:", porta)
            portasAbertas += str(porta) + ","
        tcpSock.close()
        time.sleep(1)

    except Exception as ex:
        print(str(ex))
        time.sleep(15)

print("Portas abertas\n", portasAbertas)
